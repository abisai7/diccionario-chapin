
---
import Base from "../layouts/Base.astro";
import SearchBox from "../components/SearchBox.astro";
import words from "../data/words.json";
import WordCard from "../components/WordCard.astro";

const q = Astro.url.searchParams.get('q')?.toString().trim().toLowerCase() ?? '';
const results = q
  ? words.filter(w =>
      w.word.toLowerCase().includes(q) ||
      w.meaning.toLowerCase().includes(q) ||
      (w.examples||[]).some(ex => ex.toLowerCase().includes(q))
    )
  : [];
---
<Base title={`Buscar: ${q || ''}`}>
  <section class="max-w-[1100px] mx-auto px-6">
    <h1 class="text-3xl font-bold mb-4">Buscador</h1>
    <SearchBox action="/buscar" query={q} />
    {q
      ? <p class="opacity-80 mt-3">Resultados para <strong>{q}</strong>: {results.length}</p>
      : <p class="opacity-80 mt-3">Escribe para buscar palabras, significados o ejemplos.</p>
    }
    <div class="grid gap-3.5 grid-cols-[repeat(auto-fill,minmax(260px,1fr))] mt-4">
      {results.map(item => <WordCard word={item.word} meaning={item.meaning} />)}
    </div>
  </section>
</Base>
