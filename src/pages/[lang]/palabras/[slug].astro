---
export const prerender = true;

import Base from "../../../layouts/Base.astro";
import { getCollection } from "astro:content";
import { useTranslations } from "../../../utils/i18n";
import { getCategoryColor } from "../../../utils/categoryColors";
import RelatedWordsSection from "../../../components/RelatedWordsSection.astro";

export async function getStaticPaths() {
  const esWords = await getCollection("words-es");
  const enWords = await getCollection("words-en");

  const esPaths = esWords.map((entry) => ({
    params: { lang: "es", slug: entry.slug },
    props: { entry },
  }));

  const enPaths = enWords.map((entry) => ({
    params: { lang: "en", slug: entry.slug },
    props: { entry },
  }));

  return [...esPaths, ...enPaths];
}

function getRandomWords(allWords: any[], currentSlug: string, count: number = 3) {
  const filtered = allWords.filter((w) => w.slug !== currentSlug);
  const shuffled = filtered.sort(() => Math.random() - 0.5);
  return shuffled.slice(0, count);
}

function getRandomWordsByCategory(
  allWords: any[],
  currentSlug: string,
  category: string,
  count: number = 3
) {
  const filtered = allWords.filter((w) => w.slug !== currentSlug && w.data.category === category);
  const shuffled = filtered.sort(() => Math.random() - 0.5);
  return shuffled.slice(0, count);
}

const { lang } = Astro.params;
const { entry } = Astro.props;
const { Content } = await entry.render();
const word = entry.data;

// Get related words
const collection =
  lang === "es" ? await getCollection("words-es") : await getCollection("words-en");
const relatedWords = getRandomWordsByCategory(collection, entry.slug, word.category, 3);
const otherWords = getRandomWords(collection, entry.slug, 3);

const t = useTranslations(lang);

// Hreflang URLs for multilingual SEO
const alternateUrls = {
  es: `/es/palabras/${entry.slug}/`,
  en: `/en/palabras/${entry.slug}/`,
  xDefault: `/es/palabras/${entry.slug}/`,
};

// SEO optimization
const description = `${word.word}: ${word.meaning} | ${word.category} | ${word.examples?.[0] ? `${t("word.example.label")}: "${word.examples[0]}"` : ""}${word.examples?.[1] ? ` | "${word.examples[1]}"` : ""}`;
const keywords = `${word.word}, ${t("word.slang.label")}, ${word.category || t("word.slang.label")}, ${word.synonyms?.join(", ") || ""}`;

const structuredData = {
  "@context": "https://schema.org",
  "@type": "DefinedTerm",
  name: word.word,
  description: word.meaning,
  inDefinedTermSet: t("word.type"),
  termCode: entry.slug,
};
---

<Base
  title={`${t("word.page.title").replace("{word}", word.word)}`}
  description={description}
  keywords={keywords}
  type="article"
  lang={lang}
  alternateUrls={alternateUrls}
>
  <script type="application/ld+json" set:html={JSON.stringify(structuredData)} />

  <section class="mx-auto max-w-[1100px] px-6">
    <button
      onclick="history.back()"
      class="back-btn mb-4 cursor-pointer px-4 py-2.5 font-semibold transition-all duration-200 active:scale-95"
      data-umami-event="Word Back Button Click"
      data-umami-event-word={word.word}
    >
      ← {t("word.back")}
    </button>

    <article class="article-card p-6 transition-all duration-200" transition:animate="slide">
      <div class="mb-4 flex items-start justify-between gap-4">
        <div class="flex-1">
          <h1
            class="m-0 mb-2 bg-linear-to-r bg-clip-text text-[clamp(2rem,5vw,3rem)] leading-tight font-bold text-transparent"
            style="background-image: linear-gradient(135deg, var(--primary-light) 0%, var(--primary) 50%, #9333ea 100%)"
          >
            {word.word}
          </h1>
          <div class="flex items-center gap-2 text-sm">
            <span class="text-muted italic">
              [ {t("word.slang.label")} ]
            </span>
            {
              word.category && (
                <span
                  class="rounded-full px-3 py-1 text-xs font-semibold text-white"
                  style={`background-color: ${getCategoryColor(word.category)}; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1)`}
                >
                  {word.category}
                </span>
              )
            }
          </div>
        </div>
        <button
          id="share-image-btn"
          class="badge-primary-gradient hover:shadow-theme-lg inline-flex shrink-0 cursor-pointer items-center gap-2 rounded-lg px-4 py-2.5 text-sm font-semibold text-white transition-all duration-200 hover:-translate-y-0.5 active:scale-95"
          data-umami-event="Word Share Image Button Click"
          data-umami-event-word={word.word}
          data-umami-event-lang={lang}
        >
          <svg
            width="18"
            height="18"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <circle cx="18" cy="5" r="3"></circle>
            <circle cx="6" cy="12" r="3"></circle>
            <circle cx="18" cy="19" r="3"></circle>
            <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
            <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
          </svg>
          <span class="hidden sm:inline">{t("word.share")}</span>
        </button>
      </div>

      <div class="border-theme mt-6 border-t pt-4">
        <h2 class="my-0 mb-3 flex items-center gap-2 text-lg font-semibold">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M12 20h9M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19H4v-3L16.5 3.5z"></path>
          </svg>
          {t("word.definition")}
        </h2>
        <div class="accent-box my-4 rounded-lg p-4 text-base leading-relaxed">
          {word.meaning}
        </div>
      </div>

      {
        word.examples && word.examples.length > 0 && (
          <div class="border-theme mt-6 border-t pt-4">
            <h2 class="my-0 mb-3 flex items-center gap-2 text-lg font-semibold">
              <svg
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <line x1="8" y1="6" x2="21" y2="6" />
                <line x1="8" y1="12" x2="21" y2="12" />
                <line x1="8" y1="18" x2="21" y2="18" />
                <line x1="3" y1="6" x2="3.01" y2="6" />
                <line x1="3" y1="12" x2="3.01" y2="12" />
                <line x1="3" y1="18" x2="3.01" y2="18" />
              </svg>
              {t("word.examples")}
            </h2>
            <ul class="mt-4 space-y-2 pl-5">
              {word.examples.map((ex) => (
                <li class="example-box my-2 p-3 text-sm leading-relaxed italic">"{ex}"</li>
              ))}
            </ul>
          </div>
        )
      }

      {
        Content && (
          <div class="prose border-theme mt-6 pt-4">
            <Content />
          </div>
        )
      }

      <RelatedWordsSection
        words={relatedWords}
        title={t("word.related")}
        icon="chat"
        lang={lang}
        titleLevel="h3"
      />

      <RelatedWordsSection
        words={otherWords}
        title={t("word.explore")}
        icon="pencil"
        lang={lang}
        titleLevel="h3"
      />
    </article>
  </section>

  <style>
    .prose {
      color: var(--prose-text);
      max-width: 65ch;
    }
    .prose :global(h2) {
      color: var(--prose-headings);
      font-weight: 700;
      margin-top: 2em;
      margin-bottom: 1em;
      line-height: 1.3;
    }
    .prose :global(h3) {
      color: var(--prose-headings);
      font-weight: 600;
      margin-top: 1.6em;
      margin-bottom: 0.6em;
      line-height: 1.4;
    }
    .prose :global(p) {
      margin-top: 1.25em;
      margin-bottom: 1.25em;
      line-height: 1.75;
    }
    .prose :global(ul),
    .prose :global(ol) {
      margin-top: 1.25em;
      margin-bottom: 1.25em;
      padding-left: 1.625em;
    }
    .prose :global(li) {
      margin-top: 0.5em;
      margin-bottom: 0.5em;
    }
    .prose :global(strong) {
      color: var(--prose-bold);
      font-weight: 600;
    }
    .prose :global(a) {
      color: var(--prose-links);
      text-decoration: underline;
      font-weight: 500;
    }
    .prose :global(code) {
      color: var(--prose-code);
      font-weight: 600;
      font-size: 0.875em;
    }
    .prose :global(pre) {
      background-color: var(--prose-pre-bg);
      overflow-x: auto;
      font-size: 0.875em;
      line-height: 1.7;
      margin-top: 1.7em;
      margin-bottom: 1.7em;
      border-radius: 0.375rem;
      padding: 0.8em 1em;
    }
    .prose :global(blockquote) {
      font-style: italic;
      color: var(--prose-quotes);
      border-left: 0.25rem solid var(--border);
      padding-left: 1em;
      margin-top: 1.6em;
      margin-bottom: 1.6em;
    }
  </style>

  <script define:vars={{ word, slug: entry.slug, lang }}>
    document.getElementById("share-image-btn")?.addEventListener("click", async () => {
      await document.fonts.ready;

      const canvas = document.createElement("canvas");
      const ctx = canvas.getContext("2d");

      canvas.width = 630;
      canvas.height = 630;

      // Gradient background
      const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
      gradient.addColorStop(0, "#1e293b");
      gradient.addColorStop(1, "#0f172a");
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // Decorative rounded border
      ctx.strokeStyle = "#3b82f6";
      ctx.lineWidth = 4;
      ctx.beginPath();
      ctx.roundRect(20, 20, canvas.width - 40, canvas.height - 40, 20);
      ctx.stroke();

      // Load and draw logo SVG
      const logoSvg = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1387 756"><g><path
      d="M 183.46 531.93 C180.69,531.57 177.02,530.55 175.31,529.66 C170.74,527.30 165.37,520.51 164.10,515.50 C162.67,509.79 162.71,508.35 164.49,502.35 C167.55,492.03 179.00,484.87 189.82,486.50 C195.41,487.33 202.00,490.53 202.00,492.40 C202.00,495.45 199.60,495.85 193.42,493.83 C188.19,492.11 186.73,492.00 182.98,493.01 C168.75,496.84 165.76,516.40 178.24,524.01 C182.76,526.76 191.33,526.71 195.94,523.90 C199.23,521.89 199.44,521.88 200.69,523.59 C202.68,526.32 202.28,527.80 199.11,529.45 C194.64,531.75 189.00,532.65 183.46,531.93 ZM 308.12 531.94 C300.63,530.30 295.80,524.41 295.22,516.26 C294.86,511.12 295.14,510.06 297.79,506.42 C301.41,501.46 306.26,499.00 312.43,499.00 C317.18,499.00 324.00,501.22 324.00,502.76 C324.00,503.23 323.42,504.41 322.72,505.37 C321.67,506.81 320.95,506.93 318.66,506.06 C309.75,502.67 302.00,506.96 302.00,515.29 C302.00,523.69 309.01,528.36 317.33,525.50 C321.59,524.03 324.00,524.79 324.00,527.60 C324.00,530.65 314.30,533.31 308.12,531.94 ZM 341.38 532.04 C336.12,531.22 332.80,529.03 330.00,524.50 C328.16,521.53 327.84,519.81 328.17,514.67 C328.81,504.70 333.66,499.81 343.57,499.18 C351.12,498.70 356.30,500.87 355.81,504.31 C355.57,506.00 354.93,506.43 353.00,506.18 C340.82,504.64 341.22,504.58 337.50,508.30 C331.53,514.27 333.34,522.44 341.28,525.47 C345.21,526.97 346.02,526.98 350.02,525.60 C353.42,524.43 354.61,524.36 355.20,525.29 C358.11,529.87 350.72,533.48 341.38,532.04 ZM 389.12 531.91 C387.27,531.52 384.57,530.34 383.12,529.29 C379.64,526.76 376.00,519.44 376.02,515.04 C376.04,510.41 379.65,504.16 384.02,501.19 C386.94,499.20 388.46,498.88 393.52,499.20 C403.38,499.80 409.00,505.91 409.00,516.02 C409.00,526.80 399.79,534.17 389.12,531.91 ZM 398.76 525.00 C399.88,525.00 402.99,517.87 403.00,515.28 C403.00,510.35 397.86,505.00 393.12,505.00 C388.53,505.00 385.20,507.27 383.38,511.64 C380.07,519.56 387.36,528.19 395.41,525.88 C397.10,525.40 398.61,525.00 398.76,525.00 ZM 478.09 531.53 C466.86,527.75 463.53,512.71 471.94,503.70 C475.38,500.01 476.24,499.61 481.66,499.22 C486.98,498.83 487.93,499.07 490.80,501.48 L 494.00 504.18 L 494.00 495.09 L 494.00 486.00 L 496.86 486.00 C499.64,486.00 499.74,486.17 500.30,492.25 C500.61,495.69 500.61,506.04 500.28,515.25 L 499.69 532.00 L 497.25 532.00 C495.66,532.00 494.63,531.31 494.29,530.01 C493.78,528.06 493.72,528.06 491.14,529.89 C487.87,532.19 482.19,532.91 478.09,531.53 ZM 491.25 522.99 C494.36,519.57 494.77,515.77 492.58,510.55 C490.87,506.44 488.41,505.00 483.15,505.00 C477.74,505.00 474.00,509.26 474.00,515.44 C474.00,525.72 484.56,530.33 491.25,522.99 ZM 520.43 532.06 C508.54,529.22 503.14,516.35 509.65,506.31 C517.72,493.87 537.56,498.03 539.17,512.50 L 539.50 515.50 L 527.02 515.78 C520.15,515.94 514.15,516.45 513.68,516.92 C512.21,518.39 515.75,523.66 519.36,525.37 C523.84,527.49 525.73,527.43 530.27,525.00 C533.39,523.32 534.34,523.20 536.01,524.24 C538.45,525.76 538.48,526.27 536.25,528.22 C532.21,531.74 525.71,533.32 520.43,532.06 ZM 531.77 508.75 C529.82,505.79 524.42,504.02 520.65,505.10 C517.59,505.98 514.00,508.71 514.00,510.15 C514.00,510.62 518.33,511.00 523.62,511.00 L 533.24 511.00 L 531.77 508.75 ZM 605.50 531.51 C600.30,529.64 598.00,526.72 598.00,521.95 C598.00,512.92 608.16,508.94 619.40,513.55 C621.09,514.24 621.22,514.01 620.57,511.41 C619.00,505.14 614.43,503.20 607.07,505.70 C602.96,507.09 602.53,507.07 601.34,505.46 C599.72,503.23 600.42,502.14 604.59,500.40 C608.94,498.58 617.34,498.61 620.91,500.46 C625.78,502.97 627.10,507.44 626.78,520.21 C626.53,530.43 626.32,531.51 624.57,531.85 C623.50,532.05 622.08,531.46 621.40,530.53 C620.29,529.02 619.92,529.00 617.83,530.32 C614.17,532.65 609.85,533.06 605.50,531.51 ZM 618.08 524.08 C621.57,520.59 621.11,518.52 616.51,517.00 C612.80,515.78 608.37,516.51 605.75,518.79 C603.47,520.77 603.54,522.54 606.00,525.00 C609.07,528.07 614.49,527.66 618.08,524.08 ZM 658.56 531.94 C653.89,531.13 649.00,526.26 649.00,522.43 C649.00,519.21 651.51,514.33 653.76,513.16 C657.35,511.31 662.69,511.00 667.31,512.39 C671.79,513.74 672.00,513.71 672.00,511.84 C672.00,508.70 670.31,506.37 667.05,505.02 C664.52,503.97 663.18,504.04 658.97,505.42 C653.55,507.19 652.00,506.90 652.00,504.13 C652.00,499.50 666.62,497.25 672.69,500.95 C677.65,503.98 678.35,506.24 678.43,519.50 L 678.50 531.50 L 675.68 531.82 C673.49,532.07 672.73,531.67 672.30,530.03 C671.79,528.10 671.60,528.05 670.01,529.49 C667.49,531.78 663.06,532.72 658.56,531.94 ZM 667.34 525.89 C670.73,524.35 672.69,520.54 671.09,518.61 C669.13,516.25 662.64,515.62 659.09,517.45 C651.25,521.51 659.17,529.61 667.34,525.89 ZM 700.38 531.92 C698.66,531.42 696.69,530.33 696.00,529.50 C694.25,527.40 693.00,527.63 693.00,530.07 C693.00,531.73 692.46,532.07 690.25,531.82 L 687.50 531.50 L 687.23 509.07 C687.08,496.37 687.36,486.24 687.88,485.72 C688.39,485.21 689.74,485.10 690.90,485.47 C692.81,486.08 693.00,486.88 693.00,494.57 C693.00,499.21 693.27,503.00 693.59,503.00 C693.92,503.00 695.33,502.10 696.73,501.00 C700.16,498.30 708.38,498.28 712.44,500.95 C722.64,507.68 722.38,525.18 712.00,530.48 C708.24,532.40 703.86,532.95 700.38,531.92 ZM 710.24 524.27 C714.30,520.62 714.40,511.81 710.44,507.53 C708.22,505.13 706.07,504.52 701.50,504.97 C692.51,505.85 690.28,520.09 698.35,525.11 C701.91,527.32 707.26,526.94 710.24,524.27 ZM 753.33 531.10 C748.45,528.84 747.00,526.58 747.00,521.24 C747.00,516.49 750.04,513.23 755.65,511.97 C759.01,511.21 761.10,511.41 768.00,513.13 C769.97,513.62 769.55,509.27 767.40,506.89 C764.91,504.13 761.17,503.74 755.81,505.67 C751.52,507.21 750.77,507.25 749.96,505.97 C748.59,503.79 749.24,502.69 753.06,500.75 C757.32,498.59 765.12,498.49 769.45,500.55 C774.62,503.00 775.50,505.75 775.50,519.40 C775.50,531.30 775.46,531.51 773.18,531.83 C771.51,532.07 770.70,531.57 770.31,530.09 C769.78,528.05 769.75,528.05 767.10,529.93 C762.92,532.91 758.13,533.31 753.33,531.10 ZM 765.75 525.01 C770.36,522.20 770.24,518.57 765.50,517.00 C761.09,515.55 756.45,516.52 754.50,519.30 C752.56,522.08 752.60,522.60 755.00,525.00 C757.54,527.54 761.60,527.54 765.75,525.01 ZM 838.50 532.08 C831.74,530.42 827.61,525.67 826.41,518.19 C825.56,512.87 827.87,506.46 832.08,502.42 C834.84,499.78 835.78,499.50 841.96,499.50 C847.27,499.50 849.26,499.92 850.90,501.40 L 853.00 503.31 L 853.00 494.76 C853.00,485.58 854.01,483.86 858.09,486.05 C859.94,487.04 860.02,488.17 859.77,509.30 L 859.50 531.50 L 856.68 531.82 C854.51,532.07 853.73,531.67 853.31,530.09 C852.78,528.06 852.73,528.05 850.14,529.89 C846.86,532.21 842.42,533.04 838.50,532.08 ZM 848.01 525.33 C851.47,523.29 853.00,520.13 853.00,515.01 C853.00,507.49 845.38,502.56 838.84,505.84 C829.00,510.77 832.37,526.56 843.35,526.94 C844.36,526.97 846.46,526.25 848.01,525.33 ZM 879.69 531.99 C868.61,529.96 862.95,518.16 868.18,508.01 C871.34,501.89 875.91,499.00 882.41,499.00 C889.37,499.00 893.95,501.57 896.75,507.04 C897.99,509.45 899.00,512.45 899.00,513.71 C899.00,515.98 898.88,516.00 886.00,516.00 C871.95,516.00 871.72,516.10 874.14,521.40 C875.18,523.69 881.19,527.00 884.31,527.00 C885.01,527.00 887.29,526.12 889.39,525.06 C892.47,523.48 893.57,523.34 895.10,524.30 C897.44,525.76 897.46,526.29 895.25,528.22 C891.17,531.78 885.72,533.10 879.69,531.99 ZM 891.01 509.02 C889.53,506.25 886.78,505.00 882.20,505.00 C878.39,505.00 873.00,507.97 873.00,510.07 C873.00,510.58 877.29,511.00 882.54,511.00 C891.72,511.00 892.03,510.93 891.01,509.02 ZM 1046.33 531.55 C1044.58,530.79 1042.67,529.26 1042.08,528.15 C1041.49,527.04 1041.00,521.38 1041.00,515.57 L 1041.00 505.00 L 1038.47 505.00 C1037.08,505.00 1035.68,504.32 1035.36,503.49 C1034.60,501.53 1036.72,499.00 1039.12,499.00 C1040.53,499.00 1041.00,498.27 1041.00,496.08 C1041.00,491.64 1041.98,490.00 1044.61,490.00 C1046.77,490.00 1047.00,490.42 1047.00,494.45 L 1047.00 498.89 L 1051.75 499.20 C1056.07,499.47 1056.50,499.73 1056.50,502.00 C1056.50,504.27 1056.07,504.53 1051.75,504.80 L 1047.00 505.11 L 1047.00 514.93 C1047.00,522.30 1047.36,525.06 1048.45,525.96 C1050.48,527.65 1053.81,526.34 1054.19,523.70 C1054.68,520.27 1059.40,520.63 1059.80,524.13 C1060.48,529.96 1052.59,534.30 1046.33,531.55 ZM 1074.53 531.48 C1063.43,528.62 1058.80,515.59 1065.39,505.73 C1069.57,499.46 1079.26,497.13 1086.63,500.63 C1090.53,502.48 1095.00,509.27 1095.00,513.34 L 1095.00 516.00 L 1082.00 516.00 C1069.84,516.00 1069.00,516.12 1069.00,517.92 C1069.00,521.03 1073.76,525.86 1077.53,526.57 C1079.99,527.03 1082.19,526.60 1085.49,525.00 C1089.16,523.23 1090.34,523.04 1091.53,524.02 C1093.82,525.93 1093.29,527.67 1089.75,529.79 C1085.31,532.46 1080.43,533.00 1074.53,531.48 ZM 1088.00 510.04 C1088.00,507.60 1083.49,505.00 1079.25,505.00 C1074.24,505.00 1071.50,506.19 1069.99,509.02 C1068.97,510.93 1069.28,511.00 1078.46,511.00 C1083.90,511.00 1088.00,510.59 1088.00,510.04 ZM 1217.00 532.02 C1209.72,530.67 1207.00,527.81 1207.00,521.49 C1207.00,513.79 1216.98,508.88 1225.45,512.41 C1230.07,514.34 1230.00,514.34 1230.00,512.55 C1230.00,509.28 1227.56,506.01 1224.32,504.94 C1221.56,504.03 1220.01,504.15 1215.91,505.63 C1211.54,507.20 1210.77,507.24 1209.96,505.97 C1208.51,503.68 1208.77,503.11 1212.25,500.99 C1216.25,498.55 1225.74,498.30 1230.03,500.52 C1234.95,503.06 1236.00,506.47 1236.00,519.95 L 1236.00 532.00 L 1233.41 532.00 C1231.64,532.00 1230.64,531.35 1230.28,529.98 C1229.91,528.54 1229.41,528.24 1228.55,528.96 C1225.86,531.19 1220.38,532.64 1217.00,532.02 ZM 1227.08 524.08 C1230.63,520.52 1230.09,518.40 1225.28,517.07 C1220.71,515.80 1216.30,516.74 1214.46,519.35 C1212.56,522.07 1212.61,522.61 1215.00,525.00 C1218.07,528.07 1223.49,527.66 1227.08,524.08 ZM 214.22 530.34 C207.87,527.21 204.38,518.60 206.31,510.79 C207.53,505.85 213.05,500.27 217.57,499.42 C229.22,497.24 238.45,504.36 238.40,515.50 C238.37,521.72 236.08,526.19 231.26,529.47 C226.82,532.49 219.35,532.87 214.22,530.34 ZM 225.47 525.58 C235.61,521.34 233.02,505.09 222.18,505.02 C217.83,504.99 215.36,506.41 213.51,509.98 C210.39,516.02 212.74,523.74 218.39,526.02 C221.32,527.20 221.62,527.18 225.47,525.58 ZM 245.71 531.38 C245.32,530.99 245.00,520.67 245.00,508.45 C245.00,486.73 245.05,486.22 247.10,485.69 C252.01,484.40 252.06,484.64 251.77,508.86 L 251.50 531.50 L 248.96 531.80 C247.57,531.96 246.10,531.77 245.71,531.38 ZM 267.07 530.25 C260.61,526.96 257.26,519.21 258.98,511.57 C260.77,503.65 266.88,499.00 275.48,499.00 C283.95,499.01 290.99,505.24 291.00,512.75 L 291.00 516.00 L 278.00 516.00 C266.21,516.00 265.00,516.17 265.00,517.78 C265.00,521.89 271.22,527.00 276.22,527.00 C277.49,527.00 280.27,526.07 282.40,524.92 C285.84,523.08 286.44,523.02 287.77,524.35 C293.24,529.81 275.90,534.75 267.07,530.25 ZM 284.00 509.62 C284.00,508.04 280.61,505.61 277.23,504.75 C273.74,503.87 268.39,505.76 266.58,508.52 L 264.95 511.00 L 274.48 511.00 C281.92,511.00 284.00,510.70 284.00,509.62 ZM 363.44 530.71 C363.17,529.99 363.07,522.68 363.22,514.46 L 363.50 499.50 L 366.00 499.50 C368.35,499.50 368.55,499.93 369.35,506.50 C369.81,510.35 369.88,517.66 369.50,522.75 C368.84,531.70 368.73,532.00 366.38,532.00 C365.03,532.00 363.71,531.42 363.44,530.71 ZM 416.44 530.71 C416.17,529.99 416.07,522.68 416.22,514.46 C416.50,499.66 416.53,499.50 418.82,499.17 C420.49,498.93 421.30,499.43 421.69,500.92 C422.21,502.92 424.00,503.88 424.00,502.16 C424.00,500.77 428.85,499.00 432.64,499.00 C437.29,499.00 441.60,501.63 443.21,505.44 C444.01,507.34 444.50,512.84 444.50,520.00 L 444.50 531.50 L 441.50 531.50 L 438.50 531.50 L 438.00 519.78 C437.44,506.72 436.62,504.94 431.08,504.78 C424.87,504.61 421.91,510.58 422.07,523.00 C422.11,526.58 422.12,530.06 422.08,530.75 C421.98,532.40 417.08,532.37 416.44,530.71 ZM 563.71 531.38 C563.32,530.99 563.00,520.84 563.00,508.83 L 563.00 487.00 L 573.61 487.00 C582.62,487.00 584.81,487.33 588.06,489.15 C592.44,491.61 594.52,495.67 594.40,501.50 C594.21,510.81 588.85,515.00 577.14,515.00 L 570.08 515.00 L 569.79 523.25 C569.51,531.25 569.42,531.51 566.96,531.80 C565.57,531.96 564.10,531.77 563.71,531.38 ZM 585.57 506.92 C586.73,505.64 587.45,503.36 587.45,501.00 C587.45,494.82 585.04,493.00 576.85,493.00 L 570.00 493.00 L 570.00 501.00 L 570.00 509.00 L 576.85 509.00 C582.51,509.00 584.02,508.64 585.57,506.92 ZM 636.00 509.06 C636.00,494.71 636.38,485.88 637.01,485.49 C637.56,485.15 638.91,485.16 640.01,485.50 C641.92,486.11 642.00,487.05 642.00,509.07 L 642.00 532.00 L 639.00 532.00 L 636.00 532.00 L 636.00 509.06 ZM 727.00 516.13 C727.00,506.44 727.40,499.87 728.01,499.49 C729.76,498.41 733.00,500.05 733.00,502.02 C733.00,503.70 733.27,503.64 735.52,501.39 C737.38,499.53 738.88,498.96 741.27,499.19 C744.12,499.46 744.50,499.85 744.50,502.50 C744.50,504.83 744.05,505.51 742.50,505.52 C739.05,505.57 736.04,507.05 734.81,509.32 C734.16,510.52 733.37,516.00 733.06,521.50 L 732.50 531.50 L 729.75 531.82 L 727.00 532.13 L 727.00 516.13 ZM 784.85 529.16 C779.51,524.38 783.32,520.56 789.00,525.00 C792.17,527.48 796.20,527.54 798.37,525.14 C800.94,522.30 799.38,520.25 792.85,517.87 C782.86,514.22 780.11,507.74 786.04,501.80 C788.85,499.00 789.51,498.79 794.53,499.21 C800.35,499.69 804.00,501.98 804.00,505.15 C804.00,507.44 800.25,507.66 797.44,505.53 C794.82,503.55 792.64,503.64 790.68,505.81 C789.23,507.40 789.21,507.85 790.50,509.69 C791.30,510.84 793.20,512.06 794.73,512.42 C800.33,513.73 803.13,515.35 804.55,518.09 C806.79,522.43 806.34,525.81 803.08,529.08 C800.49,531.66 799.46,532.00 794.09,532.00 C788.84,532.00 787.60,531.62 784.85,529.16 ZM 932.44 530.11 C927.51,527.87 921.35,520.91 920.00,516.07 C916.98,505.19 922.38,493.41 932.63,488.48 C938.06,485.87 948.33,485.94 953.48,488.61 C958.05,490.98 958.53,491.90 956.59,494.54 C955.23,496.39 954.99,496.41 952.32,494.89 C947.93,492.38 944.47,491.89 939.28,493.04 C924.90,496.25 921.30,514.41 933.32,523.12 C936.51,525.43 938.35,526.00 942.58,526.00 C945.49,526.00 949.02,525.56 950.43,525.02 C952.66,524.18 953.00,523.46 953.00,519.57 L 953.00 515.10 L 947.25 514.80 C941.86,514.52 941.50,514.34 941.50,512.00 C941.50,509.55 941.66,509.49 950.27,509.21 C957.25,508.98 959.15,509.22 959.60,510.39 C959.91,511.20 959.79,515.38 959.33,519.68 L 958.50 527.50 L 954.04 529.75 C948.32,532.63 938.36,532.80 932.44,530.11 ZM 972.42 530.86 C967.79,528.61 966.50,524.38 966.50,511.50 L 966.50 499.50 L 969.50 499.50 L 972.50 499.50 L 973.00 511.40 C973.48,522.88 973.59,523.36 976.19,525.29 C978.57,527.07 979.22,527.15 982.01,525.99 C987.07,523.90 988.33,520.93 988.95,509.63 C989.49,499.64 989.53,499.50 992.00,499.50 L 994.50 499.50 L 994.77 515.75 L 995.05 532.00 L 992.43 532.00 C990.66,532.00 989.64,531.36 989.29,530.01 C988.77,528.03 988.77,528.03 985.98,530.01 C982.94,532.18 976.03,532.61 972.42,530.86 ZM 1004.92 529.08 C1002.63,526.78 1002.00,525.26 1002.00,522.00 C1002.00,513.93 1010.72,509.19 1019.82,512.33 L 1024.00 513.77 L 1024.00 511.04 C1024.00,505.43 1018.16,503.02 1010.89,505.63 C1006.54,507.20 1005.77,507.24 1004.96,505.97 C1004.45,505.16 1004.16,504.05 1004.33,503.50 C1004.96,501.34 1011.64,499.00 1017.17,499.00 C1021.75,499.00 1023.41,499.48 1025.79,501.48 C1030.30,505.27 1031.10,508.34 1030.79,520.54 L 1030.50 531.50 L 1027.50 531.50 C1025.20,531.50 1024.57,531.09 1024.79,529.75 C1025.17,527.49 1024.40,527.54 1021.27,530.00 C1019.44,531.44 1017.22,532.00 1013.29,532.00 C1008.61,532.00 1007.44,531.59 1004.92,529.08 ZM 1021.35 524.55 C1025.33,520.87 1024.85,518.31 1019.93,516.98 C1014.39,515.49 1009.25,517.16 1008.35,520.75 C1006.91,526.48 1016.31,529.23 1021.35,524.55 ZM 1101.47 530.77 C1101.18,530.02 1101.07,522.69 1101.22,514.47 C1101.48,500.61 1101.64,499.50 1103.43,499.15 C1104.50,498.95 1105.92,499.54 1106.60,500.46 C1107.72,502.01 1108.07,502.01 1110.86,500.57 C1115.56,498.14 1121.21,498.54 1124.43,501.52 L 1127.15 504.05 L 1130.15 501.52 C1132.26,499.75 1134.34,499.00 1137.13,499.00 C1147.06,499.00 1150.24,504.52 1149.79,521.00 L 1149.50 531.50 L 1146.50 531.50 L 1143.50 531.50 L 1143.00 519.66 C1142.54,508.68 1142.33,507.67 1140.11,505.88 C1137.42,503.71 1134.65,504.11 1131.50,507.13 C1129.80,508.76 1129.42,510.75 1129.00,520.27 L 1128.50 531.50 L 1125.50 531.50 L 1122.50 531.50 L 1122.00 519.66 C1121.54,508.85 1121.30,507.66 1119.22,505.97 C1117.37,504.48 1116.38,504.32 1114.03,505.14 C1109.18,506.83 1108.54,508.47 1108.00,520.40 L 1107.50 531.50 L 1104.74 531.82 C1103.10,532.01 1101.78,531.59 1101.47,530.77 ZM 1161.36 531.01 C1158.05,529.68 1156.00,525.98 1156.00,521.37 C1156.00,517.92 1156.54,516.72 1159.08,514.59 C1162.78,511.47 1171.71,510.71 1176.25,513.14 C1177.73,513.93 1178.00,513.62 1178.00,511.19 C1178.00,505.43 1172.24,502.99 1164.89,505.63 C1160.54,507.20 1159.77,507.24 1158.96,505.97 C1157.59,503.80 1158.24,502.70 1162.06,500.70 C1164.59,499.37 1167.14,498.98 1171.72,499.24 C1182.53,499.85 1185.33,504.61 1184.81,521.50 L 1184.50 531.50 L 1181.75 531.82 C1179.54,532.07 1179.00,531.73 1179.00,530.08 L 1179.00 528.03 L 1175.75 530.01 C1172.33,532.09 1165.26,532.58 1161.36,531.01 ZM 1174.02 525.49 C1180.99,521.88 1178.92,516.77 1170.41,516.60 C1166.73,516.52 1165.45,516.97 1163.91,518.86 C1161.51,521.82 1161.52,522.52 1164.00,525.00 C1166.38,527.38 1170.02,527.56 1174.02,525.49 ZM 1193.45 530.73 C1193.18,530.02 1193.08,519.79 1193.23,507.98 L 1193.50 486.50 L 1196.75 486.19 L 1200.00 485.87 L 1200.00 508.94 L 1200.00 532.00 L 1196.97 532.00 C1195.30,532.00 1193.72,531.43 1193.45,530.73 ZM 390.00 494.34 C390.00,493.97 391.14,491.72 392.54,489.34 C394.79,485.50 395.50,485.00 398.66,485.00 C402.68,485.00 402.60,485.26 396.61,491.75 C393.96,494.62 390.00,496.17 390.00,494.34 ZM 363.75 492.92 C361.06,491.35 361.53,487.17 364.54,485.80 C366.72,484.81 367.39,484.95 369.20,486.76 C371.22,488.77 371.24,488.99 369.63,491.44 C367.83,494.19 366.51,494.53 363.75,492.92 ZM 506.00 470.31 C502.00,468.88 502.00,468.85 502.00,404.96 C502.00,333.15 500.77,340.00 513.71,340.00 C522.76,340.00 523.83,340.64 524.24,346.34 C524.38,348.35 524.79,350.00 525.14,350.00 C525.49,350.00 527.97,348.19 530.64,345.97 C533.31,343.76 538.20,340.96 541.50,339.75 C546.81,337.81 549.17,335.88 562.02,323.03 C586.91,298.12 608.24,266.60 621.01,235.87 C624.98,226.31 625.95,225.80 638.80,226.59 C646.33,227.05 649.48,226.83 652.88,225.59 C659.21,223.29 664.20,223.52 666.76,226.25 C667.92,227.49 670.41,232.10 672.29,236.50 C685.91,268.29 706.76,298.80 732.47,324.54 C742.66,334.74 764.91,353.00 767.15,353.00 C767.52,353.00 767.83,350.94 767.83,348.42 C767.83,341.34 769.64,340.00 779.15,340.00 C791.94,340.00 791.00,336.41 791.00,385.37 C791.00,425.70 790.95,426.80 788.93,429.37 C787.01,431.81 786.29,432.00 779.08,432.00 C767.23,432.00 768.00,434.63 768.00,394.27 L 768.00 360.19 L 763.25 357.43 C752.41,351.14 739.14,340.08 724.90,325.50 C711.30,311.56 700.99,298.81 690.66,283.15 L 682.52 270.80 L 678.73 271.31 C673.49,272.01 668.85,270.53 663.51,266.46 C657.95,262.21 655.76,262.12 652.99,266.02 C650.20,269.94 645.59,272.29 642.18,271.54 C640.70,271.21 637.52,269.39 635.11,267.48 C630.08,263.50 627.40,263.20 621.61,265.96 C619.35,267.05 615.88,268.57 613.89,269.35 C611.06,270.47 609.27,272.45 605.54,278.60 C595.79,294.66 577.04,318.03 563.63,330.83 C559.98,334.32 557.00,337.30 557.00,337.47 C557.00,337.64 559.14,338.07 561.75,338.43 C569.49,339.51 578.17,344.33 584.31,350.97 C590.86,358.04 594.48,365.04 596.49,374.52 C600.50,393.46 595.49,410.70 582.41,422.93 C573.67,431.11 567.55,433.42 554.50,433.46 C545.74,433.50 543.80,433.17 538.88,430.86 C535.79,429.42 531.40,426.55 529.13,424.50 C526.86,422.45 524.97,421.16 524.94,421.63 C524.91,422.11 524.79,432.55 524.69,444.84 C524.50,467.00 524.48,467.19 522.14,469.09 C520.35,470.53 518.28,470.98 513.64,470.92 C510.26,470.88 506.83,470.60 506.00,470.31 ZM 562.34 410.35 C571.61,403.87 576.34,391.81 574.06,380.50 C570.38,362.25 554.84,353.20 539.46,360.37 C529.91,364.81 524.62,373.92 524.56,386.01 C524.53,392.17 525.01,394.49 527.22,399.02 C532.55,409.92 539.69,414.24 551.34,413.62 C556.92,413.32 558.94,412.72 562.34,410.35 ZM 649.62 261.00 C655.83,255.27 659.88,255.52 667.98,262.15 C670.46,264.19 672.55,265.00 675.31,265.00 C677.43,265.00 679.00,264.66 678.80,264.25 C678.60,263.84 676.20,258.99 673.47,253.47 C670.74,247.95 667.21,240.42 665.64,236.72 C662.45,229.21 661.16,228.63 654.22,231.58 C651.42,232.77 647.92,233.08 640.04,232.83 C629.75,232.51 629.56,232.54 628.29,235.00 C624.63,242.11 616.04,261.37 616.38,261.71 C616.60,261.93 618.29,261.19 620.14,260.06 C625.57,256.75 631.90,257.26 637.17,261.42 C639.55,263.31 642.35,264.88 643.39,264.92 C644.43,264.97 647.23,263.20 649.62,261.00 ZM 186.50 432.53 C155.52,425.78 134.96,400.24 135.02,368.59 C135.07,341.29 147.72,320.78 171.55,309.35 C189.46,300.76 214.26,301.05 232.10,310.05 C239.04,313.55 244.01,317.65 243.98,319.84 C243.97,320.75 242.16,324.31 239.95,327.75 C235.20,335.17 233.65,335.51 225.50,330.91 C218.13,326.75 211.09,325.03 201.43,325.01 C189.33,324.99 182.61,327.32 173.25,334.75 C154.38,349.75 153.37,381.98 171.20,399.86 C186.66,415.36 208.54,416.95 229.34,404.10 C232.28,402.28 233.20,402.13 235.40,403.14 C238.18,404.40 244.00,413.72 244.00,416.90 C244.00,421.39 228.95,429.81 216.18,432.48 C207.41,434.30 194.73,434.33 186.50,432.53 ZM 831.74 432.50 C821.37,429.88 814.43,425.32 809.89,418.17 C804.81,410.16 806.59,406.75 817.12,404.32 L 823.31 402.89 L 827.67 407.87 C832.73,413.65 836.60,415.25 845.59,415.25 C854.50,415.25 858.39,412.88 858.81,407.21 C859.24,401.32 856.37,398.99 843.72,394.98 C819.23,387.20 810.97,379.85 811.02,365.85 C811.06,354.83 816.91,346.31 827.94,341.20 C835.12,337.87 849.91,336.96 858.08,339.34 C870.55,342.96 880.77,353.84 876.79,359.27 C876.08,360.24 872.65,361.89 869.18,362.95 L 862.85 364.86 L 859.10 361.47 C854.46,357.28 851.21,356.00 845.18,356.00 C835.89,356.01 830.31,362.89 834.73,368.87 C836.25,370.93 839.95,372.59 851.68,376.51 C870.50,382.80 876.90,387.28 880.61,396.75 C881.81,399.83 882.13,402.79 881.76,407.46 C880.87,418.54 874.32,426.81 863.00,431.15 C855.83,433.90 839.98,434.58 831.74,432.50 ZM 1087.74 431.23 C1073.66,426.28 1062.85,416.09 1057.90,403.12 C1056.53,399.52 1055.58,394.19 1055.25,388.28 C1054.81,380.44 1055.08,377.97 1057.06,371.80 C1060.11,362.32 1066.05,353.79 1073.70,347.93 C1082.27,341.34 1089.32,338.86 1101.24,338.24 C1112.49,337.65 1117.42,338.69 1127.00,343.65 C1142.83,351.85 1151.76,365.90 1152.76,384.18 C1153.14,391.14 1152.82,394.24 1151.12,399.82 C1143.17,426.00 1113.98,440.46 1087.74,431.23 ZM 1111.72 412.38 C1125.69,407.65 1133.33,391.86 1128.87,376.96 C1125.87,366.95 1115.65,358.96 1104.83,358.18 C1094.60,357.44 1084.47,364.16 1079.76,374.82 C1078.22,378.30 1077.88,380.86 1078.19,386.87 C1078.64,395.91 1080.71,400.75 1086.65,406.70 C1093.31,413.36 1102.59,415.47 1111.72,412.38 ZM 1190.18 432.99 C1178.67,430.56 1167.26,421.92 1164.82,413.80 C1163.67,409.94 1163.74,409.62 1166.25,407.46 C1168.94,405.15 1177.88,402.63 1180.22,403.53 C1180.92,403.81 1182.56,405.58 1183.85,407.48 C1187.30,412.52 1193.51,415.18 1201.88,415.18 C1212.11,415.18 1216.05,412.66 1215.97,406.17 C1215.91,401.09 1211.44,398.06 1198.04,394.05 C1183.12,389.58 1172.54,382.65 1169.38,375.28 C1167.39,370.64 1167.66,360.34 1169.91,355.40 C1172.46,349.78 1177.74,344.76 1184.68,341.36 C1190.11,338.70 1191.30,338.52 1202.50,338.55 C1216.38,338.59 1220.84,340.05 1228.39,347.01 C1236.53,354.51 1236.19,359.38 1227.33,362.40 C1221.07,364.54 1218.68,364.42 1216.41,361.86 C1211.76,356.64 1200.92,354.44 1194.98,357.51 C1189.69,360.24 1188.32,366.36 1192.18,369.96 C1193.39,371.08 1199.93,373.79 1206.72,375.99 C1220.89,380.58 1225.50,382.75 1230.53,387.16 C1236.15,392.09 1238.38,397.31 1238.38,405.50 C1238.37,417.99 1232.31,426.06 1219.14,431.09 C1212.77,433.53 1197.48,434.53 1190.18,432.99 ZM 351.12 431.65 C349.98,430.27 350.50,425.86 353.10,414.72 C354.04,410.70 354.74,409.72 357.55,408.54 C360.25,407.42 361.01,406.43 361.58,403.33 C362.81,396.53 365.00,392.14 367.34,391.81 C369.09,391.56 370.07,389.82 372.50,382.58 C374.45,376.80 376.20,373.28 377.50,372.58 C380.37,371.03 380.58,370.58 381.90,363.16 C383.33,355.14 383.86,354.16 386.98,353.68 C389.01,353.38 389.59,352.41 390.71,347.49 C392.20,340.91 393.42,339.00 396.12,339.00 C397.86,339.00 398.00,338.06 398.00,326.20 C398.00,317.58 398.39,313.01 399.20,312.20 C400.90,310.50 443.10,310.50 444.80,312.20 C445.60,313.00 446.00,317.44 446.00,325.60 L 446.00 337.80 L 448.93 338.83 C451.53,339.73 452.01,340.56 453.09,346.03 C454.14,351.41 454.66,352.33 457.10,353.18 C460.02,354.20 461.24,356.77 462.47,364.50 C463.45,370.64 464.01,372.00 465.58,372.00 C467.64,372.00 470.58,377.28 472.53,384.47 C473.91,389.58 474.68,390.82 476.98,391.69 C479.78,392.74 480.54,394.28 482.95,403.64 C483.77,406.83 484.61,407.94 486.58,408.43 C489.75,409.23 491.37,412.92 493.11,423.31 C494.23,430.05 494.21,431.25 492.96,432.05 C492.11,432.59 462.55,432.98 421.87,432.98 C364.51,433.00 352.05,432.76 351.12,431.65 ZM 395.46 423.75 C398.66,404.94 408.00,346.61 408.00,345.48 C408.00,343.56 398.14,343.35 397.55,345.25 C397.34,345.94 396.57,349.20 395.84,352.50 C394.73,357.47 394.11,358.55 392.25,358.82 C389.40,359.22 388.51,360.93 386.94,368.91 C385.75,374.94 383.86,378.21 381.02,379.16 C380.34,379.39 378.78,383.38 377.56,388.04 C375.46,396.00 375.13,396.57 372.00,397.60 C368.56,398.74 368.53,398.79 365.63,411.17 C365.18,413.07 364.17,414.02 362.13,414.47 C359.59,415.03 359.08,415.79 357.80,421.05 L 356.35 427.00 L 375.63 427.00 L 394.91 427.00 L 395.46 423.75 ZM 442.94 425.25 C442.91,424.29 439.87,405.73 436.19,384.00 L 429.50 344.50 L 422.24 344.21 C416.98,343.99 414.85,344.27 414.52,345.21 C414.27,345.92 411.37,363.15 408.06,383.50 C404.76,403.85 401.76,421.96 401.40,423.75 L 400.75 427.00 L 421.88 427.00 C441.35,427.00 443.00,426.86 442.94,425.25 ZM 487.63 425.25 C487.35,424.29 486.63,421.62 486.04,419.33 C485.16,415.91 484.44,415.04 482.08,414.52 C479.47,413.94 479.02,413.22 477.54,407.16 C475.57,399.14 475.34,398.76 471.54,397.48 C468.79,396.55 468.43,395.82 466.53,387.49 C464.75,379.68 464.18,378.46 462.24,378.18 C459.39,377.77 458.49,376.05 456.96,368.00 C455.55,360.64 454.75,359.25 451.70,358.81 C449.90,358.55 449.28,357.33 448.00,351.50 L 446.47 344.50 L 441.10 344.19 L 435.73 343.89 L 436.44 348.19 C436.84,350.56 438.44,360.60 440.00,370.50 C441.57,380.40 444.30,397.16 446.08,407.75 L 449.32 427.00 L 468.73 427.00 C486.74,427.00 488.10,426.87 487.63,425.25 ZM 413.20 331.76 L 413.50 325.53 L 417.08 324.95 C419.05,324.63 422.87,324.62 425.58,324.94 L 430.50 325.50 L 430.80 331.75 L 431.10 338.00 L 435.55 338.00 L 440.00 338.00 L 440.00 327.50 L 440.00 317.00 L 422.00 317.00 L 404.00 317.00 L 404.00 327.50 L 404.00 338.00 L 408.45 338.00 L 412.90 338.00 L 413.20 331.76 ZM 425.00 334.50 C425.00,331.28 424.76,331.00 422.00,331.00 C419.24,331.00 419.00,331.28 419.00,334.50 C419.00,337.72 419.24,338.00 422.00,338.00 C424.76,338.00 425.00,337.72 425.00,334.50 ZM 261.22 430.44 L 259.00 428.89 L 259.00 366.51 C259.00,311.15 259.18,303.97 260.57,302.57 C262.68,300.46 278.18,300.31 279.91,302.39 C280.69,303.33 281.13,311.46 281.28,327.88 C281.40,341.14 281.68,351.99 281.90,352.00 C282.13,352.00 283.76,350.30 285.55,348.22 C287.33,346.14 291.19,343.10 294.14,341.47 C299.13,338.71 300.23,338.50 310.00,338.50 C319.89,338.50 320.82,338.68 326.00,341.60 C333.02,345.55 338.22,352.35 341.15,361.43 C343.32,368.14 343.44,370.02 343.47,398.34 L 343.50 428.17 L 341.14 430.09 C338.08,432.57 326.58,432.80 323.22,430.44 C321.06,428.93 321.00,428.39 320.96,409.19 C320.90,375.82 319.52,367.16 313.31,361.41 C310.47,358.78 303.77,357.44 298.45,358.44 C292.11,359.63 284.58,368.12 282.61,376.28 C282.25,377.81 281.93,389.15 281.92,401.47 C281.89,423.58 281.26,429.58 278.77,431.16 C276.43,432.65 263.62,432.12 261.22,430.44 ZM 618.22 430.44 L 616.00 428.89 L 616.00 386.10 C616.00,336.04 615.03,340.00 627.26,340.00 C632.83,340.00 635.28,340.42 636.43,341.57 C637.81,342.95 638.00,348.36 638.00,385.92 C638.00,435.72 638.86,432.00 627.39,432.00 C622.72,432.00 619.72,431.49 618.22,430.44 ZM 663.04 429.81 C661.05,427.68 661.00,426.51 661.00,385.81 C661.00,336.31 660.04,340.00 672.94,340.00 C680.02,340.00 681.06,340.24 682.44,342.22 C683.30,343.44 684.00,346.22 684.00,348.39 L 684.00 352.33 L 688.52 347.74 C695.79,340.37 700.65,338.50 712.50,338.50 C720.55,338.50 723.38,338.91 727.00,340.60 C735.30,344.46 742.22,353.59 744.64,363.85 C745.59,367.88 745.97,378.04 745.98,399.19 C746.00,434.03 746.72,432.00 734.47,432.00 C722.87,432.00 723.58,433.97 723.00,400.33 C722.52,372.94 722.39,371.29 720.27,367.33 C716.85,360.93 712.73,358.50 705.34,358.50 C697.12,358.50 691.81,362.06 687.51,370.47 L 684.50 376.35 L 684.00 402.76 C683.41,433.68 684.08,432.00 672.35,432.00 C666.16,432.00 664.78,431.68 663.04,429.81 ZM 900.57 430.43 C899.71,429.57 898.76,427.88 898.46,426.68 C898.16,425.48 898.05,406.13 898.21,383.67 C898.55,336.09 897.48,340.00 910.12,340.00 C919.23,340.00 921.00,341.15 921.00,347.07 L 921.00 351.00 L 924.83 347.17 C930.86,341.14 937.09,338.58 946.82,338.15 C954.49,337.82 955.62,338.03 961.48,340.92 C967.33,343.80 973.11,348.89 974.23,352.15 C974.53,353.03 976.40,351.69 979.60,348.30 C986.87,340.60 992.20,338.50 1004.50,338.51 C1016.59,338.52 1022.71,340.80 1029.03,347.64 C1037.68,357.03 1039.00,363.99 1039.00,400.18 C1039.00,433.51 1039.54,432.00 1027.50,432.00 C1015.54,432.00 1016.00,433.17 1016.00,402.55 C1016.00,372.11 1015.43,368.52 1009.57,362.41 C1005.62,358.29 1005.00,358.00 1000.07,358.00 C993.30,358.00 988.86,360.15 985.43,365.10 C980.74,371.87 980.00,377.11 980.00,403.72 C980.00,433.00 980.41,432.00 968.50,432.00 C956.51,432.00 957.00,433.29 957.00,401.68 C957.00,370.79 956.40,367.40 949.87,361.50 C945.95,357.96 945.47,357.80 940.06,358.19 C930.20,358.90 923.94,365.51 922.04,377.18 C921.48,380.65 921.01,393.51 921.01,405.75 C921.00,432.69 921.30,432.00 909.57,432.00 C904.15,432.00 901.72,431.57 900.57,430.43 ZM 617.82 324.52 C609.23,318.69 611.01,304.62 620.82,300.88 C627.25,298.43 637.32,300.99 639.85,305.71 C643.61,312.75 640.92,322.88 634.57,325.53 C629.04,327.85 622.09,327.43 617.82,324.52 ZM 773.00 326.30 C770.16,325.26 766.04,320.66 764.92,317.27 C762.80,310.85 766.37,303.33 772.66,300.94 C776.42,299.51 783.75,299.82 787.09,301.55 C795.93,306.12 796.28,319.81 787.70,325.04 C784.60,326.93 776.62,327.61 773.00,326.30 Z"
      fill='white'></path></g></svg>`;

      const logoImg = new Image();
      const logoUrl = `data:image/svg+xml;utf8,${encodeURIComponent(logoSvg)}`;

      // Logo/Título del diccionario
      ctx.fillStyle = "#60a5fa";
      ctx.font = "bold 32px 'Baloo 2 Variable', system-ui, sans-serif";
      const title = lang === "es" ? "Diccionario Chapín" : "Guatemalan Slang Dictionary";
      ctx.fillText(title, 60, 80);

      // Palabra principal
      ctx.fillStyle = "#ffffff";
      ctx.font = "bold 72px 'Alice', 'Baloo 2 Variable', system-ui, sans-serif";
      const wordText = word.word;
      ctx.fillText(wordText, 60, 180);

      // Categoría con bordes redondeados
      if (word.category) {
        ctx.fillStyle = "#3b82f6";
        ctx.beginPath();
        ctx.roundRect(60, 200, 150, 35, 8);
        ctx.fill();
        ctx.fillStyle = "#ffffff";
        ctx.font = "600 16px 'Baloo 2 Variable', system-ui, sans-serif";
        ctx.fillText(word.category.toUpperCase(), 75, 223);
      }

      // Significado
      ctx.fillStyle = "#cbd5e1";
      ctx.font = "28px 'Baloo 2 Variable', system-ui, sans-serif";
      const meaning = word.meaning;

      // Dividir el texto en líneas para que quepa
      const maxWidth = canvas.width - 120;
      const words_array = meaning.split(" ");
      let line = "";
      let y = 280;
      const lineHeight = 40;

      for (let n = 0; n < words_array.length; n++) {
        const testLine = line + words_array[n] + " ";
        const metrics = ctx.measureText(testLine);
        if (metrics.width > maxWidth && n > 0) {
          ctx.fillText(line, 60, y);
          line = words_array[n] + " ";
          y += lineHeight;
          if (y > 420) break; // Limitar líneas
        } else {
          line = testLine;
        }
      }
      ctx.fillText(line, 60, y);

      // Ejemplo (si hay)
      if (word.examples && word.examples.length > 0) {
        ctx.fillStyle = "#94a3b8";
        ctx.font = "italic 22px 'Baloo 2 Variable', system-ui, sans-serif";
        const example = word.examples[0];
        const maxExampleY = 480;

        if (y + lineHeight + 40 < maxExampleY) {
          const exampleY = Math.min(y + lineHeight + 60, maxExampleY);
          ctx.fillText(
            `"${example.substring(0, 80)}${example.length > 80 ? "..." : ""}"`,
            60,
            exampleY
          );
        }
      }

      // Footer
      ctx.fillStyle = "#475569";
      ctx.font = "18px 'Baloo 2 Variable', system-ui, sans-serif";
      ctx.fillText("chapinismos.org", 60, canvas.height - 40);

      // Dibujar logo en esquina inferior derecha
      await new Promise((resolve) => {
        logoImg.onload = () => {
          const logoWidth = 250;
          const logoHeight = 136;
          const logoX = canvas.width - logoWidth - 40;
          const logoY = canvas.height - logoHeight - 0;
          ctx.drawImage(logoImg, logoX, logoY, logoWidth, logoHeight);
          resolve();
        };
        logoImg.src = logoUrl;
      });

      // Sinónimos (si hay)
      if (word.synonyms && word.synonyms.length > 0) {
        ctx.fillStyle = "#64748b";
        ctx.font = "16px 'Baloo 2 Variable', system-ui, sans-serif";
        const synonymsLabel = lang === "es" ? "Sinónimos" : "Synonyms";
        const synonymsText = `${synonymsLabel}: ${word.synonyms.slice(0, 3).join(", ")}`;
        ctx.fillText(synonymsText, 60, canvas.height - 70);
      }

      // Convert canvas to blob
      canvas.toBlob(async (blob) => {
        const fileName = `${slug}-chapinismos.png`;

        // Try to use Web Share API if available
        if (
          navigator.share &&
          navigator.canShare({ files: [new File([blob], fileName, { type: "image/png" })] })
        ) {
          try {
            const file = new File([blob], fileName, { type: "image/png" });
            await navigator.share({
              files: [file],
              title: `${word.word} - ${title}`,
              text: word.meaning,
            });
          } catch (err) {
            if (err.name !== "AbortError") {
              // If sharing fails, fallback to download
              downloadImage(blob, fileName);
            }
          }
        } else {
          // Fallback: download the image
          downloadImage(blob, fileName);
        }
      });
    });

    function downloadImage(blob, fileName) {
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = fileName;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }
  </script>
</Base>
