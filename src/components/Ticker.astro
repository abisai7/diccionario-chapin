
---
import { slugify } from "../utils/slug.js";
const { words = [] } = Astro.props;
const repeated = [...words, ...words, ...words];
function chunk(arr: any[], size: number): any[][] {
  const out: any[][] = [];
  for(let i=0;i<arr.length;i+=size) out.push(arr.slice(i,i+size));
  return out;
}
const rows = chunk(repeated, Math.ceil(repeated.length/3));
---
<div class="ticker-container grid gap-3 my-6">
  {rows.map((row, idx) => (
    <div 
      class="ticker-row overflow-hidden backdrop-blur-sm relative" 
    >
      <!-- Gradientes de fade en los bordes -->
      <div class="ticker-fade-left"></div>
      <div class="ticker-fade-right"></div>
      
      <div 
        class={`ticker-content flex gap-6 whitespace-nowrap px-5 py-3 ${idx % 2 === 1 ? 'animate-[scroll_28s_linear_infinite_reverse]' : 'animate-[scroll_22s_linear_infinite]'}`} 
        aria-hidden="true"
      >
        {row.map(w => (
          <a 
            class="ticker-word inline-flex items-center gap-2 px-4 py-2 font-medium text-sm transition-all duration-300 hover:scale-105 hover:-translate-y-1 active:scale-95" 
            style="
              background: var(--card); 
              border: 1px solid var(--border); 
              border-radius: var(--radius-xl); 
              box-shadow: 0 2px 4px var(--shadow-sm), 0 1px 2px var(--shadow-xs);
              color: var(--text);
            "
            href={`/palabras/${slugify(w)}`}
          >
            <span 
              class="ticker-dot w-2 h-2 animate-pulse" 
              style="
                background: var(--primary); 
                border-radius: var(--radius-xl);
                box-shadow: 0 0 8px var(--primary);
              "
            ></span>
            <span class="ticker-text">{w}</span>
          </a>
        ))}
      </div>
    </div>
  ))}
</div>

<style>
  .ticker-container {
    position: relative;
  }

  .ticker-row {
    position: relative;
    min-height: 52px;
  }

  .ticker-row:hover .ticker-content {
    animation-play-state: paused;
  }

  .ticker-fade-left,
  .ticker-fade-right {
    position: absolute;
    top: 0;
    bottom: 0;
    width: 60px;
    z-index: 10;
    pointer-events: none;
  }

  .ticker-fade-left {
    left: 0;
    background: linear-gradient(to right, var(--background) 0%, transparent 100%);
  }

  .ticker-fade-right {
    right: 0;
    background: linear-gradient(to left, var(--background) 0%, transparent 100%);
  }

  .ticker-word {
    flex-shrink: 0;
    cursor: pointer;
    user-select: none;
    position: relative;
  }

  .ticker-word:hover {
    box-shadow: 0 4px 12px var(--shadow-md), 0 2px 4px var(--shadow-sm) !important;
    border-color: var(--primary) !important;
    background: var(--card-hover) !important;
  }

  .ticker-word:hover .ticker-text {
    color: var(--primary);
  }

  .ticker-word:hover .ticker-dot {
    animation: none;
    transform: scale(1.2);
  }

  .ticker-content {
    display: flex;
    will-change: transform;
  }

  @keyframes scroll {
    0% {
      transform: translateX(0);
    }
    100% {
      transform: translateX(-33.333%);
    }
  }

  /* Mejoras de rendimiento */
  @media (prefers-reduced-motion: reduce) {
    .ticker-content {
      animation: none !important;
    }
    
    .ticker-dot {
      animation: none !important;
    }
  }

  /* Responsive */
  @media (max-width: 768px) {
    .ticker-container {
      gap: 0.625rem;
      margin-top: 1.25rem;
      margin-bottom: 1.25rem;
    }

    .ticker-row {
      min-height: 48px;
    }

    .ticker-content {
      gap: 1rem;
      padding: 0.625rem 1rem;
    }

    .ticker-word {
      padding: 0.5rem 0.875rem;
      font-size: 0.8125rem;
      gap: 0.5rem;
    }

    .ticker-fade-left,
    .ticker-fade-right {
      width: 40px;
    }
  }

  @media (max-width: 480px) {
    .ticker-word {
      padding: 0.4rem 0.75rem;
      font-size: 0.75rem;
    }

    .ticker-dot {
      width: 0.375rem;
      height: 0.375rem;
    }
  }
</style>

