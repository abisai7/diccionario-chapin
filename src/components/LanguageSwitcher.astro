---
import { getLangFromUrl } from "../utils/i18n";

const lang = getLangFromUrl(Astro.url);
const currentPath = Astro.url.pathname;

// Remove current language prefix to get base path
const basePath = currentPath.replace(/^\/(es|en)/, "") || "/";

// Generate opposite language URL
const targetLang = lang === "es" ? "en" : "es";
const targetPath = `/${targetLang}${basePath}`;
---

<a
  href={targetPath}
  class="inline-flex items-center gap-2 rounded-lg border px-3 py-2 text-sm font-medium transition-all"
  style="
    border: 1px solid var(--border);
    background: var(--card);
    color: var(--text);
  "
  onmouseover="this.style.background='var(--card-hover)'; this.style.borderColor='var(--primary-light)';"
  onmouseout="this.style.background='var(--card)'; this.style.borderColor='var(--border)';"
  aria-label={lang === "es" ? "Switch to English" : "Cambiar a EspaÃ±ol"}
>
  <svg
    width="18"
    height="18"
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    stroke-width="2"
    stroke-linecap="round"
    stroke-linejoin="round"
  >
    <circle cx="12" cy="12" r="10"></circle>
    <path
      d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"
    ></path>
    <path d="M2 12h20"></path>
  </svg>
  <span>{lang === "es" ? "EN" : "ES"}</span>
</a>
